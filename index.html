<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Custos de Impress√£o 3D (BambuLab) ‚Äî Web App</title>
  <meta name="description" content="Calculadora de custos e precifica√ß√£o para impress√£o 3D (BambuLab), baseada na planilha XLSX." />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">üßæ</div>
      <div class="titles">
        <h1>Custos de Impress√£o 3D (BambuLab)</h1>
        <p class="subtitle">Trabalhos ‚Ä¢ Par√¢metros ‚Ä¢ Materiais ‚Ä¢ Resumo</p>
      </div>
    </div>

    <div class="actions">
      <button id="btnExportJson" class="btn">Exportar JSON</button>
      <label class="btn ghost" for="importJsonFile">Importar JSON</label>
      <input id="importJsonFile" type="file" accept="application/json" hidden />
    </div>
  </header>

  <nav class="tabs" aria-label="Navega√ß√£o">
    <button class="tab active" data-tab="jobs">Trabalhos</button>
    <button class="tab" data-tab="params">Par√¢metros</button>
    <button class="tab" data-tab="materials">Materiais</button>
    <button class="tab" data-tab="summary">Resumo</button>
  </nav>

  <main class="container">
    <section id="tab-jobs" class="panel active">
      <div class="panel-header">
        <h2>Trabalhos</h2>
        <div class="row">
          <button id="btnAddJob" class="btn">Adicionar trabalho</button>
          <input id="jobSearch" class="search" placeholder="Buscar por projeto/cliente‚Ä¶" />
        </div>
      </div>

      <div class="full-bleed">
        <div class="table-wrap">
          <table class="table" id="jobsTable">
          <thead>
            <tr>
              <th class="sticky-left">ID</th>
              <th>Data</th>
              <th>Projeto/Cliente</th>
              <th>Material</th>
              <th class="num">Peso (g)</th>
              <th class="num">Tempo (h)</th>
              <th class="num">Perda (%)</th>
              <th class="num">Embalagem (R$)</th>
              <th class="num">Desconto (%)</th>
              <th>Pago</th>
              <th>Particular</th>
              <th class="num">Pre√ßo final (R$)</th>
              <th class="num">Subtotal (R$)</th>
              <th class="num">Pre√ßo sugerido (R$)</th>
              <th class="sticky-right"></th>
            </tr>
          </thead>
          <tbody></tbody>
          </table>
        </div>
      </div>

      <details class="details full-bleed">
        <summary>Ver colunas calculadas (detalhado)</summary>
        <div class="table-wrap">
          <table class="table" id="jobsDetailsTable">
            <thead>
              <tr>
                <th class="sticky-left">ID</th>
                <th class="num">Custo material</th>
                <th class="num">Energia (kWh)</th>
                <th class="num">Custo energia</th>
                <th class="num">M√£o de obra</th>
                <th class="num">Deprecia√ß√£o</th>
                <th class="num">Manuten√ß√£o</th>
                <th class="num">Overhead</th>
                <th class="num">R$/h</th>
                <th class="num">R$/g</th>
                <th>Entrega</th>
                <th>Pgto. estimado</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </details>
    </section>

    <section id="tab-params" class="panel">
      <div class="panel-header">
        <h2>Par√¢metros gerais</h2>
        <p class="hint">Os percentuais s√£o digitados como <strong>%</strong> (ex.: 10 = 10%).</p>
      </div>

      <div class="grid">
        <div class="card">
          <h3>Energia</h3>
          <div class="form">
            <label>Tarifa de energia (R$/kWh)
              <input data-param="tarifa_energia" type="text" inputmode="decimal" />
            </label>
            <label>Energia extra por trabalho (kWh)
              <input data-param="energia_extra_kwh" type="text" inputmode="decimal" />
            </label>
          </div>
        </div>

        <div class="card">
          <h3>Equipamento</h3>
          <div class="form">
            <label>Custo da impressora (R$)
              <input data-param="custo_impressora" type="text" inputmode="decimal" />
            </label>
            <label>Custo do AMS Lite (R$) ‚Äî opcional
              <input data-param="custo_ams" type="text" inputmode="decimal" />
            </label>
            <label>Vida √∫til (horas de impress√£o)
              <input data-param="vida_util_h" type="text" inputmode="decimal" />
            </label>
            <label>Valor de revenda (R$)
              <input data-param="valor_revenda" type="text" inputmode="decimal" />
            </label>

            <div class="kpi">
              <div>
                <div class="kpi-label">Custo total do equipamento</div>
                <div id="kpiEquipTotal" class="kpi-value">‚Äî</div>
              </div>
              <div>
                <div class="kpi-label">Deprecia√ß√£o por hora</div>
                <div id="kpiDepHora" class="kpi-value">‚Äî</div>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <h3>Opera√ß√£o</h3>
          <div class="form">
            <label>M√£o de obra (R$/hora)
              <input data-param="mao_de_obra_h" type="text" inputmode="decimal" />
            </label>
            <label>Manuten√ß√£o (R$/hora)
              <input data-param="manutencao_h" type="text" inputmode="decimal" />
            </label>
            <label>Overhead/administrativo (%)
              <input data-param="overhead_pct" type="text" inputmode="decimal" />
            </label>
            <label>Lucro desejado (%)
              <input data-param="lucro_pct" type="text" inputmode="decimal" />
            </label>
            <label>Embalagem padr√£o (R$/trabalho)
              <input data-param="embalagem_padrao" type="text" inputmode="decimal" />
            </label>
          </div>
        </div>
      </div>
    </section>

    <section id="tab-materials" class="panel">
      <div class="panel-header">
        <h2>Materiais (filamentos)</h2>
        <div class="row">
          <button id="btnAddMaterial" class="btn">Adicionar material</button>
        </div>
      </div>

      <div class="table-wrap">
        <table class="table" id="materialsTable">
          <thead>
            <tr>
              <th>Material</th>
              <th>Marca/Fornecedor</th>
              <th class="num">Pre√ßo (R$/kg)</th>
              <th class="num">Custo (R$/g)</th>
              <th class="num">Pot√™ncia m√©dia (W)</th>
              <th class="num">Desperd√≠cio padr√£o (%)</th>
              <th class="sticky-right"></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <p class="hint">O <strong>custo por grama</strong> √© calculado automaticamente (pre√ßo/kg √∑ 1000).</p>
    </section>

    <section id="tab-summary" class="panel">
      <div class="panel-header">
        <h2>Resumo</h2>
        <p class="hint">Soma apenas os trabalhos marcados como ‚ÄúIncluir = SIM‚Äù.</p>
      </div>

      <div class="grid grid-2">
        <div class="card">
          <h3>Totais</h3>
          <div class="kpi-list">
            <div class="kpi-row">
              <div class="kpi-label">Total de trabalhos</div>
              <div id="sumJobs" class="kpi-value">‚Äî</div>
            </div>
            <div class="kpi-row">
              <div class="kpi-label">Total Subtotal</div>
              <div id="sumSubtotal" class="kpi-value">‚Äî</div>
            </div>
            <div class="kpi-row">
              <div class="kpi-label">Total Overhead</div>
              <div id="sumOverhead" class="kpi-value">‚Äî</div>
            </div>
            <div class="kpi-row">
              <div class="kpi-label">Total Pre√ßo sugerido</div>
              <div id="sumSuggested" class="kpi-value">‚Äî</div>
            </div>
            <div class="kpi-row">
              <div class="kpi-label">Total Custo sem M√£o de Obra</div>
              <div id="sumNoLabor" class="kpi-value">‚Äî</div>
            </div>
            <div class="kpi-row">
              <div class="kpi-label">Total Devido (Pre√ßo final)</div>
              <div id="sumDue" class="kpi-value">‚Äî</div>
            </div>
          </div>
        </div>

        <div class="card">
          <h3>Receb√≠veis</h3>
          <div class="kpi-list">
            <div class="kpi-row">
              <div class="kpi-label">Total Recebido (Pago = SIM)</div>
              <div id="sumPaid" class="kpi-value">‚Äî</div>
            </div>
            <div class="kpi-row">
              <div class="kpi-label">Total Atrasado (Pago = ATRASADO)</div>
              <div id="sumLate" class="kpi-value">‚Äî</div>
            </div>
          </div>

          <p class="hint">Dica: use ‚ÄúPago = ATRASADO‚Äù para cobrar depois.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    Feito para rodar 100% no navegador (GitHub Pages). Os dados ficam salvos localmente no seu dispositivo.
  </footer>

  <script type="module" src="app.js?v=20260226_0105"></script>
</body>
</html>
